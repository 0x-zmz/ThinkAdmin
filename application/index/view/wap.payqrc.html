<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>扫码支付DEMO</title>
    <link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css">
</head>
<body style="text-align:center">

<div class="contrainer">
    <h3>扫码支付DEMO</h3>
    <div id="showbox"></div>
    <p id="orderno bg-success"></p>
    <button data-reset class="btn btn-default">重置订单号</button>
</div>

</body>
<script src="//cdn.bootcss.com/jquery/1.11.0/jquery.min.js"></script>
<script src="//cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script>
    $(function () {

        payTest.call(this), setInterval(payTest, 3000);

        /*! 支付测试动作 */
        function payTest() {
            $.get('{:url("payqrc")}', {'action': 'payqrc'}, function (ret) {
                if (ret.code === 2) {
                    ret.url = '__STATIC__/theme/default/img/wechat/qrc_payed.jpg';
                }
                console.log(ret);
                $('#showbox').html('<img class="img-thumbnail" src="' + ret.url + '"/>');
                $('#orderno').html('订单号：' + ret.order_no);
            });
        }

        $('[data-reset]').on('click', function () {
            $.get('{:url("payqrc")}', {'action': 'reset'}, function () {
                window.location.reload();
            });
        });
    });
</script>
</html>